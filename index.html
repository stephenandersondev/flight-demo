<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- jQuery -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <!-- Flight release -->
    <script src="http://flightjs.github.io/release/latest/flight.min.js"></script>
    <title>Flight Demo App</title>
    <style>
        .container {
            display: flex;
            justify-content: center;
            margin: 5px;
        }

        #count {
            font-size: x-large;
            font-weight: bold;
        }
    </style>
    <script>
       
        document.addEventListener("DOMContentLoaded", () => {

            //use to swap between versions of code
            const version = 1

            if(version === 1) {

                //version #1- just uses one component
                function count() {
                    this.attributes ({
                        incrementSelector: '#increment',
                        decrementSelector: '#decrement',
                        resetSelector: '#reset',
                        inputSelector: '#input',
                        countSelector: '#count'
                    })

                    this.count = 0

                    this.increment = function() {
                        this.count++
                        this.trigger('update-count')
                    }

                    this.decrement = function() {
                        if(this.count > 0) this.count--
                        this.trigger('update-count')
                    }

                    this.reset = function() {
                        this.count = 0
                        this.trigger('update-count')
                    }

                    this.setCount = function(e) {
                        this.count = e.target.value
                        this.trigger('update-count')
                        $('#input').val("")
                    }

                    this.updateCount = function() {
                        $('#count').html(this.count)
                    }

                    this.after('initialize', function() {
                        this.on('click', {
                            incrementSelector: this.increment,
                            decrementSelector: this.decrement,
                            resetSelector: this.reset
                        })
                        this.on('#input', 'blur', {
                            inputSelector: this.setCount
                        })
                        this.on('update-count', this.updateCount)
                    })
                }

                flight.component(count).attachTo('body')

            } else {

                 //version #2- uses multiple components
                 function count() {
                    this.attributes ({
                        incrementSelector: '#increment',
                        decrementSelector: '#decrement',
                        resetSelector: '#reset',
                        inputSelector: '#input',
                        countSelector: '#count'
                    })

                    this.count = 0

                    this.increment = function() {
                        this.count++
                        this.trigger('update-count')
                    }

                    this.decrement = function() {
                        if(this.count > 0) this.count--
                        // $('#count').html(this.count)
                    }

                    this.reset = function() {
                        this.count = 0
                        $('#count').html(this.count)
                    }

                    this.setCount = function(e) {
                        this.count = e.target.value
                        $('#count').html(this.count)
                        $('#input').val("")
                    }

                    this.updateCount = function() {
                        $('#count').html(this.count)
                    }

                    this.after('initialize', function() {
                        this.on('click', {
                            incrementSelector: this.increment,
                            decrementSelector: this.decrement,
                            resetSelector: this.reset
                        })
                        this.on('#input', 'blur', {
                            inputSelector: this.setCount
                        })
                        this.on('update-count', this.updateCount)
                    })
                }

                flight.component(count).attachTo('body')
            }

        })
    </script>
</head>
<body>
    <div class="container">
        <span id="count">0</span>
    </div>
    <div class="container">
        <button id="decrement">Decrement</button>
        <input type="number" id="input" placeholder="Initial count"/>
        <button id="increment">Increment</button>
    </div>
    <div class="container">
        <button id="reset">Reset</button>
    </div>
</body>
</html>